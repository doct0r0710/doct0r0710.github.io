<html>

<head>
    <title>PKEC Popup response</title>
</head>

<body>
    <script type="text/javascript">
        //////////////////////////////////////////////////////////////////////
        // OAUTH REDIRECT HANDLING

        // Handle the redirect back from the authorization server and
        // get an access token from the token endpoint

        var q = parseQueryString(window.location.search.substring(1));

        window.opener.postMessage(JSON.stringify(q), "*");

        // Parse a query string into an object
        function parseQueryString(string) {
            if (string == "") {
                return {};
            }
            var segments = string.split("&").map(s => s.split("="));
            var queryString = {};
            segments.forEach(s => queryString[s[0]] = s[1]);
            return queryString;
        }
    </script>
</body>

</html>